#!/bin/sh

{{#vault.environmentVariables}}
export {{name}}=$(vault read -field={{key}} {{secret}})
{{/vault.environmentVariables}}

java \
  -Ddeployment.environment=${DEPLOYMENT_ENVIRONMENT} \
  -Ddeployment.stack=${DEPLOYMENT_STACK} \
  -Dlogging.console.enabled=true \
  -Dserver.use-forward-headers=true \
  ${JAVA_OPTS} \
{{#vault.systemProperties}}
  -D{{name}}=$(vault read -field={{key}} {{secret}}) \
{{/vault.systemProperties}}
  -jar /home/{{runAsUser}}/{{buildArtifactName}}
